R2

Router>enable
Router#conf t
Router(config)#hostname R2
R2(config)# interface loopback 0
R2(config-if)#ip address 2.2.2.2 255.255.255.255
R2(config-if)# exit

R2(config)#int e0/0
R2(config-if)#ip address 10.0.0.2 255.255.255.0
R2(config-if)#no shut

R2(config)#int e0/1
R2(config-if)#ip address 10.0.1.2 255.255.255.0
R2(config-if)#no shut

R2(config)#router ospf 1

R2(config-router)#network 2.2.2.0 0.0.0.255 area 0
R2(config-router)#network 10.0.0.0 0.0.0.255 area 0
R2(config-router)#network 10.0.1.0 0.0.0.255 area 0
R2(config-router)#exit

R2#show ip route ospf

Codes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP
 D - EIGRP, EX - EIGRP external, O - OSPF, IA - OSPF inter area 
 N1 - OSPF NSSA external type 1, N2 - OSPF NSSA external type 2
 E1 - OSPF external type 1, E2 - OSPF external type 2
 i - IS-IS, su - IS-IS summary, L1 - IS-IS level-1, L2 - IS-IS level-2
 ia - IS-IS inter area, * - candidate default, U - per-user static route
 o - ODR, P - periodic downloaded static route, H - NHRP, l - LISP
 a - application route
 + - replicated route, % - next hop override
Gateway of last resort is not set
 1.0.0.0/32 is subnetted, 1 subnets
O 1.1.1.1 [110/11] via 10.0.0.1, 00:15:32, Ethernet0/0
 3.0.0.0/32 is subnetted, 1 subnets
O 3.3.3.3 [110/11] via 10.0.1.3, 00:03:58, Ethernet0/1

R2#sh ip cef

Prefix Next Hop Interface
0.0.0.0/0 no route
0.0.0.0/8 drop
0.0.0.0/32 receive 
1.1.1.1/32 10.0.0.1 Ethernet0/0
2.2.2.2/32 receive Loopback0
3.3.3.3/32 10.0.1.3 Ethernet0/1
10.0.0.0/24 attached Ethernet0/0
10.0.0.0/32 receive Ethernet0/0
10.0.0.1/32 attached Ethernet0/0
10.0.0.2/32 receive Ethernet0/0
10.0.0.255/32 receive Ethernet0/0
10.0.1.0/24 attached Ethernet0/1
10.0.1.0/32 receive Ethernet0/1
10.0.1.2/32 receive Ethernet0/1
10.0.1.3/32 attached Ethernet0/1
10.0.1.255/32 receive Ethernet0/1
127.0.0.0/8 drop
224.0.0.0/4 drop
224.0.0.0/24 receive 
240.0.0.0/4 drop
255.255.255.255/32 receive 

R2#sh ip route 1.1.1.1

Routing entry for 1.1.1.1/32
 Known via "ospf 1", distance 110, metric 11, type intra area
 Last update from 10.0.0.1 on Ethernet0/0, 00:33:11 ago
 Routing Descriptor Blocks:
 * 10.0.0.1, from 1.1.1.1, 00:33:11 ago, via Ethernet0/0
 Route metric is 11, traffic share count is 1

R2#sh ip route 3.3.3.3

Routing entry for 3.3.3.3/32
 Known via "ospf 1", distance 110, metric 11, type intra area
 Last update from 10.0.1.3 on Ethernet0/1, 00:21:49 ago
 Routing Descriptor Blocks:
 * 10.0.1.3, from 3.3.3.3, 00:21:49 ago, via Ethernet0/1
 Route metric is 11, traffic share count is 1

R2#sh ip cef 1.1.1.1

1.1.1.1/32
 nexthop 10.0.0.1 Ethernet0/0

R2#sh ip cef 3.3.3.3

3.3.3.3/32
 nexthop 10.0.1.3 Ethernet0/1

R2(config)#mpls label range 200 299
R2(config)#mpls label protocol ldp
R2(config)#mpls ldp router-id loopback 0

R2(config)#int e0/0
R2(config-if)#mpls ip

R2(config-if)#int e0/1
R2(config-if)#mpls ip

R2#sh mpls interfaces

Interface IP Tunnel BGP Static Operational
Ethernet0/0 Yes (ldp) No No No Yes 
Ethernet0/1 Yes (ldp) No No No Yes 

R2#sh mpls forwarding-table

Local Outgoing Prefix Bytes Label Outgoing Next Hop 
Label Label or Tunnel Id Switched interface 
200 Pop Label 1.1.1.1/32 0 Et0/0 10.0.0.1 
201 Pop Label 3.3.3.3/32 1266 Et0/1 10.0.1.3 

R2#sh mpls ldp neighbor

 Peer LDP Ident: 1.1.1.1:0; Local LDP Ident 2.2.2.2:0
 TCP connection: 1.1.1.1.646 - 2.2.2.2.27963
 State: Oper; Msgs sent/rcvd: 41/42; Downstream
 Up time: 00:29:24
 LDP discovery sources:
 Ethernet0/0, Src IP addr: 10.0.0.1
 Addresses bound to peer LDP Ident:
 10.0.0.1 1.1.1.1 
 Peer LDP Ident: 3.3.3.3:0; Local LDP Ident 2.2.2.2:0
 TCP connection: 3.3.3.3.44196 - 2.2.2.2.646
 State: Oper; Msgs sent/rcvd: 38/38; Downstream
 Up time: 00:27:24
 LDP discovery sources:
 Ethernet0/1, Src IP addr: 10.0.1.3
 Addresses bound to peer LDP Ident:
 10.0.1.3 3.3.3.3
 
R2#sh mpls ldp bindings

 lib entry: 1.1.1.1/32, rev 2
 local binding: label: 200
 remote binding: lsr: 1.1.1.1:0, label: imp-null
 remote binding: lsr: 3.3.3.3:0, label: 300
 lib entry: 2.2.2.2/32, rev 4
 local binding: label: imp-null
 remote binding: lsr: 1.1.1.1:0, label: 100
 remote binding: lsr: 3.3.3.3:0, label: 301
 lib entry: 3.3.3.3/32, rev 6
 local binding: label: 201
 remote binding: lsr: 1.1.1.1:0, label: 101
 remote binding: lsr: 3.3.3.3:0, label: imp-null
 lib entry: 10.0.0.0/24, rev 8
 local binding: label: imp-null
 remote binding: lsr: 1.1.1.1:0, label: imp-null
 remote binding: lsr: 3.3.3.3:0, label: 302
 lib entry: 10.0.1.0/24, rev 10
 local binding: label: imp-null
 remote binding: lsr: 1.1.1.1:0, label: 102
 remote binding: lsr: 3.3.3.3:0, label: imp-null

R2#ping 1.1.1.1 source 10.0.0.2

Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 1.1.1.1, timeout is 2 seconds:
Packet sent with a source address of 10.0.0.2 
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 1/1/1 ms

R2#traceroute 1.1.1.1 source 10.0.0.2

Type escape sequence to abort.
Tracing the route to 1.1.1.1
VRF info: (vrf in name/id, vrf out name/id)
 1 10.0.0.1 2 msec 1 msec * 

R2#ping 3.3.3.3 source 10.0.1.2

Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 3.3.3.3, timeout is 2 seconds:
Packet sent with a source address of 10.0.1.2 
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 1/1/1 ms

R2#traceroute 3.3.3.3 source 10.0.1.2

Type escape sequence to abort.
Tracing the route to 3.3.3.3
VRF info: (vrf in name/id, vrf out name/id)
 1 10.0.1.3 0 msec 1 msec *

